"use strict";(()=>{var e={};e.id=333,e.ids=[333],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},7675:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{GET:()=>u});var o=r(9303),a=r(8716),i=r(670),n=r(7070),p=r(5662);async function u(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),s=parseInt(t.get("limit")||"50"),o=t.get("license_id"),a=t.get("action"),i=t.get("result"),u=t.get("operator"),c=t.get("start_date"),l=t.get("end_date"),d=p.O.from("license_logs").select(`
        *,
        licenses (
          id,
          license_key
        )
      `,{count:"exact"});o&&(d=d.eq("license_id",o)),a&&(d=d.eq("action",a)),i&&(d=d.eq("result",i)),u&&(d=d.eq("operator",u)),c&&(d=d.gte("created_at",c)),l&&(d=d.lte("created_at",l));let g=(r-1)*s,{data:h,error:x,count:I}=await d.order("created_at",{ascending:!1}).range(g,g+s-1);if(x)return console.error("查询日志失败:",x),n.NextResponse.json({error:"查询失败"},{status:500});return n.NextResponse.json({success:!0,data:{logs:h||[],pagination:{page:r,limit:s,total:I||0,pages:Math.ceil((I||0)/s)}}})}catch(e){return console.error("查询日志异常:",e),n.NextResponse.json({error:"服务器内部错误"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/logs/route",pathname:"/api/logs",filename:"route",bundlePath:"app/api/logs/route"},resolvedPagePath:"C:\\Users\\Ad\\Desktop\\授权后台\\app\\api\\logs\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:g}=c,h="/api/logs/route";function x(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},5662:(e,t,r)=>{r.d(t,{O:()=>i});var s=r(9498);let o=process.env.SUPABASE_URL||"https://qjukpzpvbxajiawdlcxo.supabase.co",a=process.env.SUPABASE_SERVICE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFqdWtwenB2Ynhhamlhd2RsY3hvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4ODA2MjksImV4cCI6MjA3MzQ1NjYyOX0.aJMbToTrs2jypBVM_b4LsR2dgAIxXquS1huLViUgu0Y",i=(0,s.eI)(o,a,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,338],()=>r(7675));module.exports=s})();